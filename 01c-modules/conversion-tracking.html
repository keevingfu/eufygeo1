<!-- Conversion Tracking Module -->
<div class="module-content">
    <!-- è½¬åŒ–è·Ÿè¸ªæ ‡é¢˜ -->
    <div class="module-header">
        <h2 style="font-size: 24px; margin-bottom: 20px; color: #FF6900;">
            ğŸ“Š è½¬åŒ–è·Ÿè¸ªåˆ†æ
        </h2>
        <div class="header-actions">
            <button class="action-btn" onclick="setupTracking()">âš™ï¸ é…ç½®è·Ÿè¸ª</button>
            <button class="action-btn" onclick="exportReport()">ğŸ“‹ å¯¼å‡ºæŠ¥å‘Š</button>
            <button class="action-btn" onclick="createFunnel()">ğŸ¯ åˆ›å»ºæ¼æ–—</button>
        </div>
    </div>

    <!-- è½¬åŒ–æ¦‚è§ˆ -->
    <div class="conversion-overview">
        <h3 style="margin-bottom: 20px;">ğŸ¯ è½¬åŒ–æ¦‚è§ˆ</h3>
        <div class="overview-grid">
            <div class="overview-card">
                <div class="card-icon">ğŸ‘ï¸</div>
                <div class="card-content">
                    <div class="card-number">12,456</div>
                    <div class="card-label">é¡µé¢æµè§ˆé‡</div>
                    <div class="card-change positive">â†‘ +15.3%</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-icon">ğŸ”—</div>
                <div class="card-content">
                    <div class="card-number">3,247</div>
                    <div class="card-label">é“¾æ¥ç‚¹å‡»</div>
                    <div class="card-change positive">â†‘ +8.7%</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-icon">ğŸ›’</div>
                <div class="card-content">
                    <div class="card-number">892</div>
                    <div class="card-label">åŠ è´­è½¬åŒ–</div>
                    <div class="card-change negative">â†“ -2.1%</div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-icon">ğŸ’°</div>
                <div class="card-content">
                    <div class="card-number">267</div>
                    <div class="card-label">å®Œæˆè´­ä¹°</div>
                    <div class="card-change positive">â†‘ +12.4%</div>
                </div>
            </div>
        </div>
    </div>

    <!-- è½¬åŒ–æ¼æ–— -->
    <div class="conversion-funnel">
        <h3 style="margin-bottom: 20px;">ğŸ”½ è½¬åŒ–æ¼æ–—åˆ†æ</h3>
        <div class="funnel-container">
            <div id="conversionFunnelChart" style="height: 400px;"></div>
        </div>
        
        <div class="funnel-insights">
            <div class="insight-item">
                <div class="insight-icon">âš ï¸</div>
                <div class="insight-content">
                    <h4>å…³é”®å‘ç°</h4>
                    <p>ä»äº§å“è¯¦æƒ…é¡µåˆ°åŠ è´­çš„è½¬åŒ–ç‡åä½ï¼ˆ27.5%ï¼‰ï¼Œå»ºè®®ä¼˜åŒ–äº§å“å±•ç¤ºå’Œä»·æ ¼ç­–ç•¥</p>
                </div>
            </div>
            <div class="insight-item">
                <div class="insight-icon">ğŸ’¡</div>
                <div class="insight-content">
                    <h4>ä¼˜åŒ–å»ºè®®</h4>
                    <p>åŠ å¼ºFlexiOneæ‰‹æŒæ¸…æ´å™¨çš„åŠŸèƒ½å±•ç¤ºï¼Œå¢åŠ ç”¨æˆ·äº’åŠ¨å…ƒç´ æå‡å‚ä¸åº¦</p>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¸ é“è½¬åŒ–å¯¹æ¯” -->
    <div class="channel-conversion">
        <h3 style="margin-bottom: 20px;">ğŸ“ˆ æ¸ é“è½¬åŒ–å¯¹æ¯”</h3>
        <div class="channel-grid">
            <div class="channel-card">
                <div class="channel-header">
                    <span class="channel-name">ğŸ“± ç¤¾äº¤åª’ä½“</span>
                    <span class="channel-conversion">3.2%</span>
                </div>
                <div class="channel-metrics">
                    <div class="metric-row">
                        <span>æµé‡:</span>
                        <span>4,567</span>
                    </div>
                    <div class="metric-row">
                        <span>è½¬åŒ–:</span>
                        <span>146</span>
                    </div>
                    <div class="metric-row">
                        <span>CPA:</span>
                        <span>$23.45</span>
                    </div>
                </div>
                <div class="channel-trend positive">â†‘ +0.8%</div>
            </div>

            <div class="channel-card">
                <div class="channel-header">
                    <span class="channel-name">ğŸ” æœç´¢å¼•æ“</span>
                    <span class="channel-conversion">5.7%</span>
                </div>
                <div class="channel-metrics">
                    <div class="metric-row">
                        <span>æµé‡:</span>
                        <span>2,893</span>
                    </div>
                    <div class="metric-row">
                        <span>è½¬åŒ–:</span>
                        <span>165</span>
                    </div>
                    <div class="metric-row">
                        <span>CPA:</span>
                        <span>$18.76</span>
                    </div>
                </div>
                <div class="channel-trend positive">â†‘ +1.2%</div>
            </div>

            <div class="channel-card">
                <div class="channel-header">
                    <span class="channel-name">ğŸ“§ é‚®ä»¶è¥é”€</span>
                    <span class="channel-conversion">8.9%</span>
                </div>
                <div class="channel-metrics">
                    <div class="metric-row">
                        <span>æµé‡:</span>
                        <span>1,234</span>
                    </div>
                    <div class="metric-row">
                        <span>è½¬åŒ–:</span>
                        <span>110</span>
                    </div>
                    <div class="metric-row">
                        <span>CPA:</span>
                        <span>$15.23</span>
                    </div>
                </div>
                <div class="channel-trend positive">â†‘ +2.1%</div>
            </div>

            <div class="channel-card">
                <div class="channel-header">
                    <span class="channel-name">ğŸ’° ä»˜è´¹å¹¿å‘Š</span>
                    <span class="channel-conversion">4.3%</span>
                </div>
                <div class="channel-metrics">
                    <div class="metric-row">
                        <span>æµé‡:</span>
                        <span>3,456</span>
                    </div>
                    <div class="metric-row">
                        <span>è½¬åŒ–:</span>
                        <span>149</span>
                    </div>
                    <div class="metric-row">
                        <span>CPA:</span>
                        <span>$28.90</span>
                    </div>
                </div>
                <div class="channel-trend negative">â†“ -0.5%</div>
            </div>
        </div>
    </div>

    <!-- æ—¶é—´è¶‹åŠ¿åˆ†æ -->
    <div class="time-trend-analysis">
        <h3 style="margin-bottom: 20px;">ğŸ“… æ—¶é—´è¶‹åŠ¿åˆ†æ</h3>
        <div class="trend-controls">
            <button class="trend-period active" onclick="changePeriod('7d')">7å¤©</button>
            <button class="trend-period" onclick="changePeriod('30d')">30å¤©</button>
            <button class="trend-period" onclick="changePeriod('90d')">90å¤©</button>
        </div>
        <div id="conversionTrendChart" style="height: 300px; margin-top: 20px;"></div>
    </div>

    <!-- ç”¨æˆ·è¡Œä¸ºè·¯å¾„ -->
    <div class="user-journey">
        <h3 style="margin-bottom: 20px;">ğŸ›¤ï¸ ç”¨æˆ·è¡Œä¸ºè·¯å¾„</h3>
        <div class="journey-flow">
            <div class="journey-step">
                <div class="step-circle">1</div>
                <div class="step-content">
                    <h4>é¦–æ¬¡è®¿é—®</h4>
                    <p>100% (12,456)</p>
                    <small>å¹³å‡åœç•™: 2:34</small>
                </div>
            </div>
            <div class="journey-arrow">â†’</div>
            <div class="journey-step">
                <div class="step-circle">2</div>
                <div class="step-content">
                    <h4>äº§å“é¡µé¢</h4>
                    <p>68% (8,470)</p>
                    <small>å¹³å‡åœç•™: 4:12</small>
                </div>
            </div>
            <div class="journey-arrow">â†’</div>
            <div class="journey-step">
                <div class="step-circle">3</div>
                <div class="step-content">
                    <h4>è¯¦ç»†ä¿¡æ¯</h4>
                    <p>45% (5,605)</p>
                    <small>å¹³å‡åœç•™: 3:28</small>
                </div>
            </div>
            <div class="journey-arrow">â†’</div>
            <div class="journey-step">
                <div class="step-circle">4</div>
                <div class="step-content">
                    <h4>åŠ å…¥è´­ç‰©è½¦</h4>
                    <p>27% (3,363)</p>
                    <small>æµå¤±ç‡: 73%</small>
                </div>
            </div>
            <div class="journey-arrow">â†’</div>
            <div class="journey-step">
                <div class="step-circle">5</div>
                <div class="step-content">
                    <h4>å®Œæˆè´­ä¹°</h4>
                    <p>8% (996)</p>
                    <small>æœ€ç»ˆè½¬åŒ–</small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.conversion-overview {
    margin-bottom: 30px;
}

.overview-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.overview-card {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s;
}

.overview-card:hover {
    background: rgba(255, 255, 255, 0.05);
    transform: translateY(-3px);
}

.card-icon {
    font-size: 32px;
}

.card-content {
    flex: 1;
}

.card-number {
    font-size: 24px;
    font-weight: bold;
    color: #FF6900;
    margin-bottom: 4px;
}

.card-label {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 4px;
}

.card-change {
    font-size: 11px;
    font-weight: 500;
}

.card-change.positive { color: #52C41A; }
.card-change.negative { color: #F5222D; }

.conversion-funnel {
    margin-bottom: 30px;
}

.funnel-container {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
}

.funnel-insights {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.insight-item {
    display: flex;
    gap: 15px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
}

.insight-icon {
    font-size: 24px;
}

.insight-content h4 {
    margin: 0 0 8px 0;
    font-size: 14px;
    color: #FF6900;
}

.insight-content p {
    margin: 0;
    font-size: 13px;
    line-height: 1.5;
    color: rgba(255, 255, 255, 0.8);
}

.channel-conversion {
    margin-bottom: 30px;
}

.channel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.channel-card {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s;
}

.channel-card:hover {
    background: rgba(255, 255, 255, 0.05);
    transform: translateY(-3px);
}

.channel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.channel-name {
    font-size: 14px;
    font-weight: 600;
}

.channel-conversion {
    font-size: 18px;
    font-weight: bold;
    color: #FF6900;
}

.channel-metrics {
    margin-bottom: 10px;
}

.metric-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 13px;
}

.channel-trend {
    font-size: 12px;
    font-weight: 500;
    text-align: right;
}

.time-trend-analysis {
    margin-bottom: 30px;
}

.trend-controls {
    display: flex;
    gap: 5px;
    background: rgba(255, 255, 255, 0.03);
    padding: 5px;
    border-radius: 10px;
    width: fit-content;
}

.trend-period {
    padding: 8px 16px;
    background: transparent;
    border: none;
    border-radius: 6px;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    transition: all 0.3s;
    font-size: 13px;
}

.trend-period:hover {
    color: white;
    background: rgba(255, 255, 255, 0.05);
}

.trend-period.active {
    background: linear-gradient(135deg, #FF6900 0%, #FF8C00 100%);
    color: white;
}

.user-journey {
    margin-bottom: 30px;
}

.journey-flow {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    overflow-x: auto;
}

.journey-step {
    text-align: center;
    min-width: 120px;
}

.step-circle {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #FF6900 0%, #FF8C00 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: white;
    margin: 0 auto 10px;
}

.step-content h4 {
    margin: 0 0 5px 0;
    font-size: 13px;
    color: white;
}

.step-content p {
    margin: 0 0 3px 0;
    font-size: 14px;
    font-weight: 600;
    color: #FF6900;
}

.step-content small {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
}

.journey-arrow {
    font-size: 20px;
    color: rgba(255, 255, 255, 0.4);
    margin: 0 5px;
}

@media (max-width: 768px) {
    .overview-grid,
    .channel-grid {
        grid-template-columns: 1fr;
    }
    
    .journey-flow {
        flex-direction: column;
        gap: 15px;
    }
    
    .journey-arrow {
        transform: rotate(90deg);
    }
}
</style>

<script>
// é…ç½®è·Ÿè¸ª
function setupTracking() {
    console.log('é…ç½®è½¬åŒ–è·Ÿè¸ª');
}

// å¯¼å‡ºæŠ¥å‘Š
function exportReport() {
    console.log('å¯¼å‡ºè½¬åŒ–æŠ¥å‘Š');
}

// åˆ›å»ºæ¼æ–—
function createFunnel() {
    console.log('åˆ›å»ºè½¬åŒ–æ¼æ–—');
}

// åˆ‡æ¢æ—¶é—´å‘¨æœŸ
function changePeriod(period) {
    document.querySelectorAll('.trend-period').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // é‡æ–°æ¸²æŸ“è¶‹åŠ¿å›¾è¡¨
    renderTrendChart(period);
    console.log('åˆ‡æ¢åˆ°æ—¶é—´å‘¨æœŸ:', period);
}

// åˆå§‹åŒ–è½¬åŒ–æ¼æ–—å›¾è¡¨
function initConversionFunnelChart() {
    if (typeof echarts === 'undefined') return;
    
    const chart = echarts.init(document.getElementById('conversionFunnelChart'));
    const option = {
        tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b} : {c}%'
        },
        series: [
            {
                name: 'è½¬åŒ–æ¼æ–—',
                type: 'funnel',
                left: '10%',
                top: 60,
                bottom: 60,
                width: '80%',
                min: 0,
                max: 100,
                minSize: '0%',
                maxSize: '100%',
                sort: 'descending',
                gap: 2,
                label: {
                    show: true,
                    position: 'inside'
                },
                labelLine: {
                    length: 10,
                    lineStyle: {
                        width: 1,
                        type: 'solid'
                    }
                },
                itemStyle: {
                    borderColor: '#fff',
                    borderWidth: 1
                },
                emphasis: {
                    label: {
                        fontSize: 20
                    }
                },
                data: [
                    { value: 100, name: 'é¡µé¢è®¿é—®' },
                    { value: 68, name: 'äº§å“é¡µé¢' },
                    { value: 45, name: 'è¯¦ç»†ä¿¡æ¯' },
                    { value: 27, name: 'åŠ å…¥è´­ç‰©è½¦' },
                    { value: 8, name: 'å®Œæˆè´­ä¹°' }
                ]
            }
        ]
    };
    
    chart.setOption(option);
    window.addEventListener('resize', () => chart.resize());
}

// æ¸²æŸ“è¶‹åŠ¿å›¾è¡¨
function renderTrendChart(period) {
    if (typeof echarts === 'undefined') return;
    
    const chart = echarts.init(document.getElementById('conversionTrendChart'));
    
    // æ ¹æ®æœŸé—´ç”Ÿæˆæ•°æ®
    let xAxisData, seriesData;
    if (period === '7d') {
        xAxisData = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'];
        seriesData = [3.2, 3.8, 4.1, 3.9, 4.5, 5.2, 4.8];
    } else if (period === '30d') {
        xAxisData = ['ç¬¬1å‘¨', 'ç¬¬2å‘¨', 'ç¬¬3å‘¨', 'ç¬¬4å‘¨'];
        seriesData = [3.5, 4.2, 4.8, 4.1];
    } else {
        xAxisData = ['ç¬¬1æœˆ', 'ç¬¬2æœˆ', 'ç¬¬3æœˆ'];
        seriesData = [3.8, 4.3, 4.6];
    }
    
    const option = {
        tooltip: {
            trigger: 'axis'
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            data: xAxisData,
            axisLine: {
                lineStyle: { color: 'rgba(255,255,255,0.2)' }
            },
            axisTick: { show: false }
        },
        yAxis: {
            type: 'value',
            axisLabel: {
                formatter: '{value}%'
            },
            axisLine: {
                lineStyle: { color: 'rgba(255,255,255,0.2)' }
            },
            splitLine: {
                lineStyle: { color: 'rgba(255,255,255,0.1)' }
            }
        },
        series: [
            {
                name: 'è½¬åŒ–ç‡',
                type: 'line',
                data: seriesData,
                smooth: true,
                lineStyle: {
                    color: '#FF6900',
                    width: 3
                },
                itemStyle: {
                    color: '#FF6900'
                },
                areaStyle: {
                    color: {
                        type: 'linear',
                        x: 0, y: 0, x2: 0, y2: 1,
                        colorStops: [
                            { offset: 0, color: 'rgba(255,105,0,0.3)' },
                            { offset: 1, color: 'rgba(255,105,0,0.05)' }
                        ]
                    }
                }
            }
        ]
    };
    
    chart.setOption(option);
}

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–å›¾è¡¨
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        initConversionFunnelChart();
        renderTrendChart('7d');
    }, 100);
});
</script>