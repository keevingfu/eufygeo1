<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracking & Attribution System - Full Chain Data Analysis Center</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Navigation Bar */
        .navbar {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .real-time-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #52C41A20, #73D13D20);
            color: #52C41A;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .pulse {
            width: 8px;
            height: 8px;
            background: #52C41A;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(82, 196, 26, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(82, 196, 26, 0); }
            100% { box-shadow: 0 0 0 0 rgba(82, 196, 26, 0); }
        }
        
        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        
        /* Real-time Data Flow */
        .realtime-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        /* Event Stream */
        .event-stream {
            display: grid;
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .event-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #1890FF;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .event-icon {
            width: 32px;
            height: 32px;
            background: #1890FF20;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        .event-details {
            flex: 1;
        }
        
        .event-type {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }
        
        .event-meta {
            font-size: 12px;
            color: #666;
        }
        
        .event-time {
            font-size: 11px;
            color: #999;
        }
        
        /* Conversion Funnel */
        .funnel-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        /* Attribution Model */
        .attribution-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .model-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .model-btn {
            padding: 8px 16px;
            background: #f5f5f5;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .model-btn.active {
            background: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);
            color: white;
        }
        
        /* UTM Management */
        .utm-builder {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .utm-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-input {
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 13px;
        }
        
        .utm-preview {
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            font-family: monospace;
            font-size: 13px;
            word-break: break-all;
        }
        
        /* AAT Management */
        .aat-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .aat-tags {
            display: grid;
            gap: 15px;
        }
        
        .aat-tag-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .aat-tag-info {
            flex: 1;
        }
        
        .aat-tag-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .aat-tag-details {
            font-size: 12px;
            color: #666;
        }
        
        .aat-tag-metrics {
            display: flex;
            gap: 20px;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 18px;
            font-weight: bold;
            color: #1890FF;
        }
        
        .metric-label {
            font-size: 11px;
            color: #999;
        }
        
        /* Valid Click Determination */
        .validation-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .validation-rules {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .rule-card {
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #f0f2f5 100%);
            border-radius: 12px;
            border-left: 4px solid #1890FF;
        }
        
        .rule-title {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .rule-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #52C41A;
        }
        
        .rule-desc {
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .rule-stats {
            display: flex;
            justify-content: space-between;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
            font-size: 12px;
        }
        
        /* Reconciliation Center */
        .reconciliation-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .data-sources {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .source-card {
            padding: 20px;
            background: #f9f9f9;
            border-radius: 12px;
            text-align: center;
        }
        
        .source-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 10px;
            background: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        
        .source-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .source-count {
            font-size: 24px;
            font-weight: bold;
            color: #1890FF;
            margin-bottom: 5px;
        }
        
        .source-status {
            font-size: 12px;
            color: #52C41A;
        }
        
        /* Button Styles */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(24,144,255,0.3);
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #52C41A 0%, #73D13D 100%);
            color: white;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
        }
        
        /* Statistics Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .stat-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }
        
        .stat-change {
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .positive {
            color: #52C41A;
        }
        
        .negative {
            color: #F5222D;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-brand">
            <div class="logo">T&A</div>
            <h2 style="font-size: 20px; color: #333;">Tracking & Attribution System</h2>
            <div class="real-time-badge">
                <span class="pulse"></span>
                Real-time Tracking
            </div>
        </div>
        <div class="btn-group">
            <button class="btn btn-secondary">⚙️ Tracking Settings</button>
            <button class="btn btn-primary">📊 Export Report</button>
        </div>
    </nav>

    <div class="container">
        <!-- Statistics Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">
                    <span>🎯</span> Today's AODV
                </div>
                <div class="stat-value">3,847</div>
                <div class="stat-change positive">
                    <span>↑</span> 12% vs Yesterday
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>✅</span> Valid Click Rate
                </div>
                <div class="stat-value">87.3%</div>
                <div class="stat-change positive">
                    <span>↑</span> 2.1% Improvement
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>🛒</span> Attributed Orders
                </div>
                <div class="stat-value">238</div>
                <div class="stat-change positive">
                    <span>↑</span> 18% Growth
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>💰</span> Attributed GMV
                </div>
                <div class="stat-value">$71.2K</div>
                <div class="stat-change positive">
                    <span>↑</span> 23% Growth
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">
                    <span>📊</span> Data Deviation
                </div>
                <div class="stat-value">2.8%</div>
                <div class="stat-change positive">
                    <span>✓</span> Normal Range
                </div>
            </div>
        </div>

        <!-- Real-time Event Stream -->
        <div class="realtime-section">
            <div class="section-header">
                <h3 class="section-title">🔄 Real-time Event Stream</h3>
                <span style="font-size: 13px; color: #666;">Last 20 Events</span>
            </div>
            <div class="event-stream">
                <div class="event-item">
                    <div class="event-icon">🎯</div>
                    <div class="event-details">
                        <div class="event-type">AODV - AI Search Arrival</div>
                        <div class="event-meta">Source: Google AOV • Page: /ao/e28-pet • UTM: aov_pet_faq</div>
                    </div>
                    <div class="event-time">Just now</div>
                </div>
                <div class="event-item" style="border-left-color: #52C41A;">
                    <div class="event-icon" style="background: #52C41A20;">📝</div>
                    <div class="event-details">
                        <div class="event-type">FormStart - Start Questionnaire</div>
                        <div class="event-meta">User: anon_abc123 • Progress: Question 1/3</div>
                    </div>
                    <div class="event-time">15 seconds ago</div>
                </div>
                <div class="event-item" style="border-left-color: #FF6900;">
                    <div class="event-icon" style="background: #FF690020;">🛒</div>
                    <div class="event-details">
                        <div class="event-type">ATC - Add to Cart</div>
                        <div class="event-meta">SKU: E28-Pro • Channel: Amazon • AAT: aov_pet_answer_pdp</div>
                    </div>
                    <div class="event-time">32 seconds ago</div>
                </div>
                <div class="event-item" style="border-left-color: #FAAD14;">
                    <div class="event-icon" style="background: #FAAD1420;">▶️</div>
                    <div class="event-details">
                        <div class="event-type">Watch50 - Video Watched 50%</div>
                        <div class="event-meta">Video: Pet Hair Cleaning Demo • Duration: 30s/60s</div>
                    </div>
                    <div class="event-time">1 minute ago</div>
                </div>
                <div class="event-item" style="border-left-color: #52C41A;">
                    <div class="event-icon" style="background: #52C41A20;">✅</div>
                    <div class="event-details">
                        <div class="event-type">Order - Order Completed</div>
                        <div class="event-meta">Order ID: AMZ-2025-0908-1234 • Amount: $299.99 • Attribution: AAT</div>
                    </div>
                    <div class="event-time">2 minutes ago</div>
                </div>
            </div>
        </div>

        <!-- Conversion Funnel -->
        <div class="funnel-section">
            <div class="section-header">
                <h3 class="section-title">📊 Conversion Funnel Analysis</h3>
                <select style="padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                    <option>Today</option>
                    <option>Last 7 Days</option>
                    <option>Last 30 Days</option>
                </select>
            </div>
            <div id="funnelChart" style="height: 350px;"></div>
        </div>

        <!-- Attribution Model -->
        <div class="attribution-section">
            <div class="section-header">
                <h3 class="section-title">🎯 Multi-Touch Attribution Analysis</h3>
                <button class="btn btn-secondary">Configure Model</button>
            </div>
            <div class="model-selector">
                <button class="model-btn active">Last Click</button>
                <button class="model-btn">First Click</button>
                <button class="model-btn">Linear Attribution</button>
                <button class="model-btn">Time Decay</button>
                <button class="model-btn">Data Driven</button>
            </div>
            <div id="attributionChart" style="height: 300px;"></div>
        </div>

        <!-- UTM Builder -->
        <div class="utm-builder">
            <div class="section-header">
                <h3 class="section-title">🔗 UTM Parameter Builder</h3>
                <button class="btn btn-primary">Generate Link</button>
            </div>
            <div class="utm-form">
                <div class="form-group">
                    <label class="form-label">Target URL</label>
                    <input type="text" class="form-input" value="https://eufy.com/e28">
                </div>
                <div class="form-group">
                    <label class="form-label">utm_source</label>
                    <input type="text" class="form-input" value="aov">
                </div>
                <div class="form-group">
                    <label class="form-label">utm_medium</label>
                    <input type="text" class="form-input" value="direct">
                </div>
                <div class="form-group">
                    <label class="form-label">utm_campaign</label>
                    <input type="text" class="form-input" value="e28_pet">
                </div>
                <div class="form-group">
                    <label class="form-label">utm_content</label>
                    <input type="text" class="form-input" value="answer">
                </div>
                <div class="form-group">
                    <label class="form-label">Unique Code</label>
                    <input type="text" class="form-input" value="E28-AI-PET-10">
                </div>
            </div>
            <div class="utm-preview">
                https://eufy.com/e28?utm_source=aov&utm_medium=direct&utm_campaign=e28_pet&utm_content=answer&aov=1&code=E28-AI-PET-10
            </div>
        </div>

        <!-- AAT Management -->
        <div class="aat-section">
            <div class="section-header">
                <h3 class="section-title">🏷️ Amazon Attribution Tag Management</h3>
                <button class="btn btn-primary">+ Create Tag</button>
            </div>
            <div class="aat-tags">
                <div class="aat-tag-item">
                    <div class="aat-tag-info">
                        <div class="aat-tag-name">aov_pet_answer_pdp</div>
                        <div class="aat-tag-details">Scenario: Pet Family • Asset: Answer Page • Landing: PDP</div>
                    </div>
                    <div class="aat-tag-metrics">
                        <div class="metric">
                            <div class="metric-value">1,234</div>
                            <div class="metric-label">Clicks</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">89</div>
                            <div class="metric-label">Orders</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">$26.7K</div>
                            <div class="metric-label">GMV</div>
                        </div>
                    </div>
                </div>
                <div class="aat-tag-item">
                    <div class="aat-tag-info">
                        <div class="aat-tag-name">aov_carpet_faq_ao</div>
                        <div class="aat-tag-details">Scenario: Carpet Cleaning • Asset: FAQ • Landing: A/O Page</div>
                    </div>
                    <div class="aat-tag-metrics">
                        <div class="metric">
                            <div class="metric-value">856</div>
                            <div class="metric-label">Clicks</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">67</div>
                            <div class="metric-label">Orders</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">$20.1K</div>
                            <div class="metric-label">GMV</div>
                        </div>
                    </div>
                </div>
                <div class="aat-tag-item">
                    <div class="aat-tag-info">
                        <div class="aat-tag-name">aov_quiet_video_pdp</div>
                        <div class="aat-tag-details">Scenario: Silent Mode • Asset: Video • Landing: PDP</div>
                    </div>
                    <div class="aat-tag-metrics">
                        <div class="metric">
                            <div class="metric-value">567</div>
                            <div class="metric-label">Clicks</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">45</div>
                            <div class="metric-label">Orders</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">$13.5K</div>
                            <div class="metric-label">GMV</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Valid Click Determination -->
        <div class="validation-section">
            <div class="section-header">
                <h3 class="section-title">✅ Valid Click Determination Rules</h3>
                <button class="btn btn-secondary">View Exclusion Log</button>
            </div>
            <div class="validation-rules">
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status"></span>
                        Dwell Time Determination
                    </div>
                    <div class="rule-desc">
                        Dwell time ≥ 8 seconds considered valid click
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 2,847</span>
                        <span>Rejected: 423</span>
                    </div>
                </div>
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status"></span>
                        Scroll Depth Determination
                    </div>
                    <div class="rule-desc">
                        Scroll depth ≥ 35% considered valid click
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 2,654</span>
                        <span>Rejected: 616</span>
                    </div>
                </div>
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status"></span>
                        Interaction Behavior Determination
                    </div>
                    <div class="rule-desc">
                        FormStart/ATC/Watch50 direct billing
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 1,892</span>
                        <span>Rejected: 0</span>
                    </div>
                </div>
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status" style="background: #F5222D;"></span>
                        Frequency Limit Determination
                    </div>
                    <div class="rule-desc">
                        Same IP >3 times in 24h excluded
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 3,156</span>
                        <span>Rejected: 114</span>
                    </div>
                </div>
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status" style="background: #F5222D;"></span>
                        Abnormal UA Determination
                    </div>
                    <div class="rule-desc">
                        Bot/Crawler/Abnormal UA direct exclusion
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 3,221</span>
                        <span>Rejected: 49</span>
                    </div>
                </div>
                <div class="rule-card">
                    <div class="rule-title">
                        <span class="rule-status"></span>
                        Geographic Location Determination
                    </div>
                    <div class="rule-desc">
                        Non-target region traffic excluded
                    </div>
                    <div class="rule-stats">
                        <span>Passed: 3,089</span>
                        <span>Rejected: 181</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reconciliation Center -->
        <div class="reconciliation-section">
            <div class="section-header">
                <h3 class="section-title">📋 Data Reconciliation Center</h3>
                <button class="btn btn-success">Generate Reconciliation Report</button>
            </div>
            <div class="data-sources">
                <div class="source-card">
                    <div class="source-icon">📊</div>
                    <div class="source-name">GA4 Server-Side</div>
                    <div class="source-count">3,847</div>
                    <div class="source-status">✓ Sync Normal</div>
                </div>
                <div class="source-card">
                    <div class="source-icon">🏷️</div>
                    <div class="source-name">Amazon Attribution</div>
                    <div class="source-count">3,762</div>
                    <div class="source-status">✓ Deviation 2.2%</div>
                </div>
                <div class="source-card">
                    <div class="source-icon">📱</div>
                    <div class="source-name">Meta CAPI</div>
                    <div class="source-count">2,189</div>
                    <div class="source-status">✓ Sync Normal</div>
                </div>
                <div class="source-card">
                    <div class="source-icon">🎯</div>
                    <div class="source-name">Internal Tracking</div>
                    <div class="source-count">3,912</div>
                    <div class="source-status">✓ Primary Data Source</div>
                </div>
            </div>
            <div id="reconciliationChart" style="height: 300px;"></div>
        </div>
    </div>

    <script>
        // Initialize funnel chart
        function initFunnelChart() {
            const chart = echarts.init(document.getElementById('funnelChart'));
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)'
                },
                series: [
                    {
                        type: 'funnel',
                        left: '10%',
                        width: '80%',
                        label: {
                            formatter: '{b}\n{c} ({d}%)'
                        },
                        data: [
                            {value: 10000, name: 'AOV Display', itemStyle: {color: '#5470c6'}},
                            {value: 3847, name: 'AODV Arrival', itemStyle: {color: '#91cc75'}},
                            {value: 2890, name: 'Valid Clicks', itemStyle: {color: '#fac858'}},
                            {value: 1234, name: 'Form/ATC', itemStyle: {color: '#ee6666'}},
                            {value: 238, name: 'Order Conversion', itemStyle: {color: '#73c0de'}}
                        ]
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize attribution chart
        function initAttributionChart() {
            const chart = echarts.init(document.getElementById('attributionChart'));
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Google AOV', 'YouTube', 'Meta', 'TikTok', 'Direct']
                },
                xAxis: {
                    type: 'category',
                    data: ['First Touch', 'Assist Touch 1', 'Assist Touch 2', 'Last Touch']
                },
                yAxis: {
                    type: 'value',
                    name: 'Attribution Value (%)'
                },
                series: [
                    {
                        name: 'Google AOV',
                        type: 'bar',
                        stack: 'total',
                        data: [40, 20, 15, 25],
                        itemStyle: {color: '#4285F4'}
                    },
                    {
                        name: 'YouTube',
                        type: 'bar',
                        stack: 'total',
                        data: [15, 25, 20, 10],
                        itemStyle: {color: '#FF0000'}
                    },
                    {
                        name: 'Meta',
                        type: 'bar',
                        stack: 'total',
                        data: [10, 15, 20, 15],
                        itemStyle: {color: '#1877F2'}
                    },
                    {
                        name: 'TikTok',
                        type: 'bar',
                        stack: 'total',
                        data: [5, 10, 15, 8],
                        itemStyle: {color: '#000000'}
                    },
                    {
                        name: 'Direct',
                        type: 'bar',
                        stack: 'total',
                        data: [30, 30, 30, 42],
                        itemStyle: {color: '#52C41A'}
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Initialize reconciliation chart
        function initReconciliationChart() {
            const chart = echarts.init(document.getElementById('reconciliationChart'));
            const option = {
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: ['Internal Tracking', 'GA4', 'AAT', 'Deviation Rate']
                },
                xAxis: {
                    type: 'category',
                    data: ['9-1', '9-2', '9-3', '9-4', '9-5', '9-6', '9-7', '9-8']
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'Event Count'
                    },
                    {
                        type: 'value',
                        name: 'Deviation Rate (%)',
                        position: 'right'
                    }
                ],
                series: [
                    {
                        name: 'Internal Tracking',
                        type: 'line',
                        data: [3200, 3456, 3678, 3890, 3567, 3789, 3912, 3847],
                        itemStyle: {color: '#1890FF'}
                    },
                    {
                        name: 'GA4',
                        type: 'line',
                        data: [3150, 3420, 3650, 3850, 3520, 3750, 3880, 3810],
                        itemStyle: {color: '#52C41A'}
                    },
                    {
                        name: 'AAT',
                        type: 'line',
                        data: [3100, 3380, 3600, 3800, 3480, 3700, 3820, 3762],
                        itemStyle: {color: '#FF6900'}
                    },
                    {
                        name: 'Deviation Rate',
                        type: 'line',
                        yAxisIndex: 1,
                        data: [3.1, 2.8, 2.5, 2.3, 2.6, 2.4, 2.2, 2.8],
                        itemStyle: {color: '#FAAD14'}
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // Attribution model switching
        document.querySelectorAll('.model-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.model-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                // Here you can reload data for the corresponding model
                initAttributionChart();
            });
        });

        // Real-time event stream simulation
        function addNewEvent() {
            const events = [
                {type: 'AODV', icon: '🎯', color: '#1890FF', meta: 'Source: Google AOV'},
                {type: 'FormStart', icon: '📝', color: '#52C41A', meta: 'Progress: Question 1/3'},
                {type: 'ATC', icon: '🛒', color: '#FF6900', meta: 'SKU: E28-Pro'},
                {type: 'Watch50', icon: '▶️', color: '#FAAD14', meta: 'Video: Product Demo'},
                {type: 'Order', icon: '✅', color: '#52C41A', meta: 'Amount: $299.99'}
            ];
            
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            const eventStream = document.querySelector('.event-stream');
            const newEvent = document.createElement('div');
            newEvent.className = 'event-item';
            newEvent.style.borderLeftColor = randomEvent.color;
            newEvent.innerHTML = `
                <div class="event-icon" style="background: ${randomEvent.color}20;">${randomEvent.icon}</div>
                <div class="event-details">
                    <div class="event-type">${randomEvent.type} - New Event</div>
                    <div class="event-meta">${randomEvent.meta}</div>
                </div>
                <div class="event-time">Just now</div>
            `;
            
            eventStream.insertBefore(newEvent, eventStream.firstChild);
            if (eventStream.children.length > 10) {
                eventStream.removeChild(eventStream.lastChild);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initFunnelChart();
            initAttributionChart();
            initReconciliationChart();
            
            // Simulate real-time events
            setInterval(addNewEvent, 5000);
        });
    </script>
</body>
</html>